{"remainingRequest":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\src\\views\\history\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\src\\views\\history\\index.vue","mtime":1600845084969},{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFRhYmxlIGZyb20gJy4vQ29tcG9uZW50cy9jb250ZW50LnZ1ZSc7CmltcG9ydCBTZWFyY2ggZnJvbSAnLi9Db21wb25lbnRzL3NlYXJjaEJhci52dWUnOwppbXBvcnQgeyByZWYsIHdhdGNoLCBjb21wdXRlZCwgcmVhY3RpdmUsIG9uTW91bnRlZCB9IGZyb20gJ0B2dWUvY29tcG9zaXRpb24tYXBpJzsKaW1wb3J0IHsgVXNlcnNIaXN0b3J5IH0gZnJvbSAnQC9hcGkvdXNlci5qcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnaGlzdG9yeScsCiAgc2V0dXA6IGZ1bmN0aW9uIHNldHVwKHByb3BzLCBfcmVmKSB7CiAgICB2YXIgcm9vdCA9IF9yZWYucm9vdDsKICAgIHZhciB0YWJsZSA9IHJlYWN0aXZlKFt7fV0pOwogICAgdmFyIGNoaWxkcmVuRGF0YSA9IHJlYWN0aXZlKHsKICAgICAgJ2hhaXJjdXQnOiB7CiAgICAgICAgbGFiZWw6ICfliarpq64nCiAgICAgIH0sCiAgICAgICdjb2xvcic6IHsKICAgICAgICBsYWJlbDogJ+afk+mrricKICAgICAgfSwKICAgICAgJ3Blcm0nOiB7CiAgICAgICAgbGFiZWw6ICfnh5npq64nCiAgICAgIH0sCiAgICAgICd0cmVhdG1lbnQnOiB7CiAgICAgICAgbGFiZWw6ICforbfnkIYnCiAgICAgIH0sCiAgICAgICdvdGhlcnMnOiB7CiAgICAgICAgbGFiZWw6ICflhbbku5YnCiAgICAgIH0KICAgIH0pOwoKICAgIHZhciBnZXRSb3dDbGFzc05hbWUgPSBmdW5jdGlvbiBnZXRSb3dDbGFzc05hbWUoX3JlZjIpIHsKICAgICAgdmFyIHJvdyA9IF9yZWYyLnJvdywKICAgICAgICAgIHJvd0luZGV4ID0gX3JlZjIucm93SW5kZXg7CgogICAgICBpZiAocm93LmRldGFpbCA9PSAwKSB7CiAgICAgICAgcmV0dXJuICdyb3ctZXhwYW5kLWNvdmVyJzsKICAgICAgfQogICAgfTsKCiAgICB2YXIgZGF0ZSA9IHJlZignJyk7CiAgICB2YXIgZGlzYWJsZVNlYWNoQnRuID0gcmVmKGZhbHNlKTsKCiAgICB2YXIgc2VhcmNoVXNlcnMgPSBmdW5jdGlvbiBzZWFyY2hVc2VycygpIHsKICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgc3RhcnQ6IGRhdGUudmFsdWVbMF0sCiAgICAgICAgZW5kOiBkYXRlLnZhbHVlWzFdCiAgICAgIH07CiAgICAgIFVzZXJzSGlzdG9yeShkYXRhKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciB0YWJsZURhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIHRhYmxlLmxlbmd0aCA9IDA7CiAgICAgICAgdmFyIG5ld2RhdGEgPSB0YWJsZURhdGEubWFwKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgICAgICAgaXRlbS5kYXRlID0gZm9ybWF0ZURhdGUoaXRlbS5kYXRlKTsKICAgICAgICAgIGl0ZW0udHlwZSA9IGl0ZW0udHlwZSA9PSAnZGVwb3NpdCcgPyAn5YSy5YC8JyA6IGl0ZW0udHlwZSA9PSAnd2l0aGRyYXcnID8gJ+aJo+asvicgOiAn6ZaL5Y2hJzsKICAgICAgICAgIHJvb3QuJHNldCh0YWJsZSwgaW5kZXgsIGl0ZW0pOwogICAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgICAgfSk7CiAgICAgICAgY29uc29sZS5sb2codGFibGVEYXRhKTsKICAgICAgICBjb25zb2xlLmxvZyhuZXdkYXRhKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgIH0pOwogICAgfTsKCiAgICB2YXIgZ2V0QWxsVXNlckluZm8gPSBmdW5jdGlvbiBnZXRBbGxVc2VySW5mbygpIHsKICAgICAgVXNlcnNIaXN0b3J5KCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgdGFibGVEYXRhMSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgdGFibGVEYXRhMS5tYXAoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICBpdGVtLmRhdGUgPSBmb3JtYXRlRGF0ZShpdGVtLmRhdGUpOwogICAgICAgICAgaXRlbS50eXBlID0gaXRlbS50eXBlID09ICdkZXBvc2l0JyA/ICflhLLlgLwnIDogaXRlbS50eXBlID09ICd3aXRoZHJhdycgPyAn5omj5qy+JyA6ICfplovljaEnOwogICAgICAgICAgcm9vdC4kc2V0KHRhYmxlLCBpbmRleCwgaXRlbSk7CiAgICAgICAgfSk7CiAgICAgICAgY29uc29sZS5sb2codGFibGVEYXRhMSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICB9KTsKICAgIH07CgogICAgb25Nb3VudGVkKGZ1bmN0aW9uICgpIHsKICAgICAgZ2V0QWxsVXNlckluZm8oKTsKICAgIH0pOwoKICAgIGZ1bmN0aW9uIHRyYW5fdmFsKHZhbCkgewogICAgICBpZiAodmFsIDwgMTApIHsKICAgICAgICB2YWwgPSAiMCIgKyB2YWw7CiAgICAgIH0KCiAgICAgIHJldHVybiB2YWw7CiAgICB9CgogICAgZnVuY3Rpb24gZm9ybWF0ZURhdGUoZGF0YSkgewogICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKGRhdGEpOwogICAgICB2YXIgeWVhciA9IGRhdGUuZ2V0RnVsbFllYXIoKTsKICAgICAgdmFyIG1vbnRoID0gdHJhbl92YWwoZGF0ZS5nZXRNb250aCgpICsgMSk7CiAgICAgIHZhciBkYXkgPSB0cmFuX3ZhbChkYXRlLmdldERhdGUoKSk7CiAgICAgIHZhciBkYXRlc3RyID0geWVhciArICItIiArIG1vbnRoICsgIi0iICsgZGF5OwogICAgICByZXR1cm4gZGF0ZXN0cjsKICAgIH0KCiAgICByZXR1cm4gewogICAgICBnZXRSb3dDbGFzc05hbWU6IGdldFJvd0NsYXNzTmFtZSwKICAgICAgdGFibGU6IHRhYmxlLAogICAgICBjaGlsZHJlbkRhdGE6IGNoaWxkcmVuRGF0YSwKICAgICAgZGF0ZTogZGF0ZSwKICAgICAgc2VhcmNoVXNlcnM6IHNlYXJjaFVzZXJzLAogICAgICBkaXNhYmxlU2VhY2hCdG46IGRpc2FibGVTZWFjaEJ0bgogICAgfTsKICB9Cn07"},{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["\r\n<template>\r\n  <div class=\"histroy_wrap\">\r\n\r\n    <div class=\"main_wrap\">\r\n      <el-date-picker\r\n        v-model=\"date\"\r\n        type=\"daterange\"\r\n        range-separator=\"至\"\r\n        start-placeholder=\"开始日期\"\r\n        end-placeholder=\"结束日期\"\r\n        value-format=\"yyyy-MM-dd\"\r\n      >\r\n      </el-date-picker>\r\n      <el-button\r\n        icon=\"el-icon-search\"\r\n        circle\r\n        :disabled=\"disableSeachBtn\"\r\n        @click=\"searchUsers\"\r\n      ></el-button>\r\n    </div>\r\n\r\n    <!---------- 表格開始---------- -->\r\n    <el-table\r\n      v-model=\"table\"\r\n      :data=\"table\"\r\n      style=\"width: 100%;margin-bottom: 20px;\"\r\n      row-key=\"_id\"\r\n      border\r\n      :row-class-name=\"getRowClassName\"\r\n    >\r\n\r\n      <el-table-column type=\"expand\">\r\n        <template slot-scope=\"scope\">\r\n          <div\r\n            v-for=\"(item,index) in scope.row.detail\"\r\n            :key=\"index\"\r\n          >\r\n            <el-form\r\n              label-position=\"left\"\r\n              inline\r\n              class=\"demo-table-expand\"\r\n            >\r\n              <el-form-item label=\"操作\">\r\n\r\n                <span>{{childrenData[item.value].label}}</span>\r\n              </el-form-item>\r\n              <el-form-item label=\"金額\">\r\n                <span>{{item.amount}}</span>\r\n              </el-form-item>\r\n            </el-form>\r\n          </div>\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"date\"\r\n        label=\"日期\"\r\n      ></el-table-column>\r\n\r\n      <el-table-column\r\n        prop=\"name\"\r\n        label=\"姓名\"\r\n      ></el-table-column>\r\n\r\n      <el-table-column\r\n        prop=\"type\"\r\n        label=\"類型\"\r\n      ></el-table-column>\r\n\r\n      <el-table-column\r\n        prop=\"amount\"\r\n        label=\"金額\"\r\n      ></el-table-column>\r\n\r\n    </el-table>\r\n\r\n    <div class=\"block\">\r\n      <span class=\"demonstration\">页数较少时的效果</span>\r\n      <el-pagination\r\n        layout=\"prev, pager, next\"\r\n        :total=\"50\"\r\n      >\r\n      </el-pagination>\r\n    </div>\r\n  </div>\r\n</template>\r\n \r\n<script>\r\n\r\nimport Table from './Components/content.vue'\r\nimport Search from './Components/searchBar.vue'\r\nimport { ref, watch, computed, reactive, onMounted } from '@vue/composition-api'\r\nimport { UsersHistory } from '@/api/user.js'\r\n\r\n\r\nexport default {\r\n  name: 'history',\r\n  setup (props, { root }) {\r\n    const table = reactive([{}])\r\n\r\n\r\n    const childrenData = reactive({\r\n      'haircut': {\r\n        label: '剪髮'\r\n      },\r\n      'color': {\r\n        label: '染髮'\r\n      },\r\n      'perm': {\r\n        label: '燙髮'\r\n      },\r\n      'treatment': {\r\n        label: '護理'\r\n      },\r\n      'others': {\r\n        label: '其他'\r\n      },\r\n\r\n    })\r\n    const getRowClassName = ({ row, rowIndex }) => {\r\n      if (row.detail == 0) {\r\n        return 'row-expand-cover';\r\n      }\r\n    }\r\n    const date = ref('')\r\n    const disableSeachBtn = ref(false)\r\n\r\n\r\n\r\n\r\n    const searchUsers = (() => {\r\n      let data = {\r\n        start: date.value[0],\r\n        end: date.value[1]\r\n      }\r\n      UsersHistory(data)\r\n        .then((response) => {\r\n\r\n          let tableData = response.data\r\n          table.length = 0\r\n\r\n          let newdata = tableData.map((item, index) => {\r\n            item.date = formateDate(item.date)\r\n            item.type = (item.type == 'deposit') ? '儲值' : (item.type == 'withdraw') ? '扣款' : '開卡'\r\n            root.$set(table, index, item)\r\n            return item\r\n          })\r\n          console.log(tableData);\r\n          console.log(newdata);\r\n\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        })\r\n    })\r\n    const getAllUserInfo = (() => {\r\n      UsersHistory()\r\n        .then((response) => {\r\n\r\n          let tableData1 = response.data\r\n          tableData1.map((item, index) => {\r\n            item.date = formateDate(item.date)\r\n            item.type = (item.type == 'deposit') ? '儲值' : (item.type == 'withdraw') ? '扣款' : '開卡'\r\n            root.$set(table, index, item)\r\n          })\r\n          console.log(tableData1);\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        })\r\n    })\r\n    onMounted(() => {\r\n      getAllUserInfo()\r\n    })\r\n\r\n\r\n    function tran_val (val) {\r\n      if (val < 10) {\r\n        val = \"0\" + val;\r\n      } return val;\r\n    }\r\n    function formateDate (data) {\r\n      var date = new Date(data);\r\n      var year = date.getFullYear();\r\n      var month = tran_val(date.getMonth() + 1);\r\n      var day = tran_val(date.getDate());\r\n      var datestr = year + \"-\" + month + \"-\" + day;\r\n      return datestr\r\n    }\r\n\r\n\r\n    return {\r\n\r\n      getRowClassName,\r\n      table,\r\n      childrenData,\r\n      date,\r\n      searchUsers,\r\n      disableSeachBtn,\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.row-expand-cover {\r\n  .el-table__expand-icon {\r\n    visibility: hidden !important;\r\n  }\r\n}\r\n.demo-table-expand {\r\n  font-size: 0;\r\n}\r\n.demo-table-expand label {\r\n  width: 90px;\r\n  color: #99a9bf;\r\n}\r\n.demo-table-expand .el-form-item {\r\n  margin-right: 0;\r\n  margin-bottom: 0;\r\n  width: 50%;\r\n}\r\n</style>"],"sourceRoot":"src/views/history"}]}