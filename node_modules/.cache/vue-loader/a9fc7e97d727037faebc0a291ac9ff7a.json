{"remainingRequest":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\src\\views\\member\\signup\\index.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\src\\views\\member\\signup\\index.vue","mtime":1601395252552},{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\missj\\OneDrive\\桌面\\vue\\vue-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KI3NpZ251cC13cmFwIHsNCiAgcG9zaXRpb246IHJlbGF0aXZlOw0KfQ0KLnVwbG9hZCB7DQogIHdpZHRoOiAzMCU7DQogIGhlaWdodDogNDAwIHB4Ow0KfQ0KLnVwbG9hZF9jb250YWluZXIgew0KICB3aWR0aDogNjAlOw0KICBtYXJnaW46IDUwcHggYXV0bzsNCn0NCi5mb3JtIHsNCiAgd2lkdGg6IDYwJTsNCn0NCg0KLmVsLXVwbG9hZC0tcGljdHVyZS1jYXJkIHsNCiAgLmVsLWljb24tcGx1cyB7DQogICAgbGluZS1oZWlnaHQ6IDMwMHB4ICFpbXBvcnRhbnQ7DQogIH0NCn0NCg0KLmhpZGUgLmVsLXVwbG9hZC0tcGljdHVyZS1jYXJkIHsNCiAgZGlzcGxheTogbm9uZTsNCn0NCg0KLmVsLXVwbG9hZC0tcGljdHVyZS1jYXJkIHsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogMzAwcHg7DQp9DQouZWwtdXBsb2FkLWxpc3QtLXBpY3R1cmUtY2FyZCB7DQogIC5lbC11cGxvYWQtbGlzdF9faXRlbSB7DQogICAgd2lkdGg6IDEwMCUgIWltcG9ydGFudDsNCiAgICBoZWlnaHQ6IDMwMHB4ICFpbXBvcnRhbnQ7DQogIH0NCn0NCi5lbC10YWJsZSAud2FybmluZy1yb3cgew0KICBiYWNrZ3JvdW5kOiBvbGRsYWNlOw0KfQ0KLmVsLXRhYmxlIC5zdWNjZXNzLXJvdyB7DQogIGJhY2tncm91bmQ6ICNmMGY5ZWI7DQp9DQoNCi5hdmF0YXItdXBsb2FkZXIgew0KICAvZGVlcC8uZWwtdXBsb2FkIHsNCiAgICBib3JkZXI6IDFweCBkYXNoZWQgI2Q5ZDlkOTsNCiAgICBib3JkZXItcmFkaXVzOiA2cHg7DQogICAgY3Vyc29yOiBwb2ludGVyOw0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICB9DQp9DQouYXZhdGFyLXVwbG9hZGVyIC5lbC11cGxvYWQ6aG92ZXIgew0KICBib3JkZXItY29sb3I6ICM0MDllZmY7DQp9DQouYXZhdGFyLXVwbG9hZGVyLWljb24gew0KICBmb250LXNpemU6IDI4cHg7DQogIGNvbG9yOiAjOGM5MzlkOw0KICB3aWR0aDogMTc4cHg7DQogIGhlaWdodDogMTc4cHg7DQogIGxpbmUtaGVpZ2h0OiAxNzhweDsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KLmF2YXRhciB7DQogIHdpZHRoOiAxNzhweDsNCiAgaGVpZ2h0OiAxNzhweDsNCiAgZGlzcGxheTogYmxvY2s7DQp9DQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/member/signup","sourcesContent":["<template>\r\n  <div id=\"signup-wrap\">\r\n\r\n    <el-form\r\n      :rules=\"rules\"\r\n      :model=\"ruleForm\"\r\n      ref=\"ruleForm\"\r\n      label-width=\"100px\"\r\n      id=\"allform floatL\"\r\n      enctype='multipart/form-dat'\r\n    >\r\n      <div class=\"upload floatL\">\r\n        <el-upload\r\n          action=\"https://www.mocky.io/v2/5185415ba171ea3a00704eed/posts/\"\r\n          ref='upload'\r\n          list-type=\"picture-card\"\r\n          :on-preview=\"handlePictureCardPreview\"\r\n          :on-remove=\"handleRemove\"\r\n          :class=\"{ hide: hideUpload }\"\r\n          :on-change=\"pictureOnchange\"\r\n          class=\"upload_container\"\r\n        >\r\n          <i class=\"el-icon-plus\"></i>\r\n        </el-upload>\r\n      </div>\r\n      <div class=\"form floatL \">\r\n        <el-form-item\r\n          label=\"姓名\"\r\n          prop=\"name\"\r\n        >\r\n          <el-input v-model=\"ruleForm.name\"></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item\r\n          label=\"性別\"\r\n          prop=\"gender\"\r\n        >\r\n          <el-radio-group v-model=\"ruleForm.gender\">\r\n            <el-radio label=\"女\"></el-radio>\r\n            <el-radio label=\"男\"></el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n\r\n        <el-form-item\r\n          label=\"卡號\"\r\n          prop=\"cardNumber\"\r\n        >\r\n          <el-input v-model.number=\"ruleForm.cardNumber\"></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item\r\n          label=\"電話\"\r\n          prop=\"phoneNumber\"\r\n        >\r\n          <el-input v-model.number=\"ruleForm.phoneNumber\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item\r\n          label=\"卡別\"\r\n          prop=\"level\"\r\n        >\r\n          <el-select\r\n            v-model=\"ruleForm.level\"\r\n            placeholder=\"请选择會員卡等級\"\r\n          >\r\n            <el-option\r\n              label=\"銀卡 \"\r\n              value=\"sliver\"\r\n            ></el-option>\r\n            <el-option\r\n              label=\"黃金\"\r\n              value=\"gold\"\r\n            ></el-option>\r\n            <el-option\r\n              label=\"vip\"\r\n              value=\"vip\"\r\n            ></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <el-form-item\r\n          label=\"儲值金\"\r\n          prop=\"amount\"\r\n        >\r\n          <el-input v-model.number=\"ruleForm.amount\"></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item\r\n          label=\"備註\"\r\n          prop=\"note\"\r\n        >\r\n          <el-input\r\n            type=\"textarea\"\r\n            v-model=\"ruleForm.note\"\r\n          ></el-input>\r\n        </el-form-item>\r\n\r\n        <el-form-item>\r\n          <el-button\r\n            type=\"primary\"\r\n            @click=\"submitForm('ruleForm')\"\r\n          >\r\n            立即创建\r\n          </el-button>\r\n          <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\r\n        </el-form-item>\r\n      </div>\r\n\r\n    </el-form>\r\n\r\n    <el-dialog :visible.sync=\"dialogVisible\">\r\n      <img\r\n        width=\"100%\"\r\n        :src=\"dialogImageUrl\"\r\n        alt=\"\"\r\n      />\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Signup } from '@/api/user.js'\r\n\r\nimport { reactive, ref, refs } from '@vue/composition-api'\r\nexport default {\r\n  name: 'signup',\r\n  setup (props, { root, refs }) {\r\n    const hideUpload = ref(false)\r\n\r\n    const dialogImageUrl = ref('')\r\n    const dialogVisible = ref(false)\r\n\r\n    const ruleForm = reactive({\r\n      name: '',\r\n      gender: '',\r\n      phoneNumber: '',\r\n      cardNumber: '',\r\n      level: '',\r\n      amount: '',\r\n      note: '',\r\n      type: 'signup',\r\n      path: ''\r\n    })\r\n\r\n    const rules = reactive({\r\n      name: [\r\n        { required: true, message: '请输入活动名称', trigger: 'blur' },\r\n      ],\r\n      gender: [\r\n        { required: true, message: '请选择性別', trigger: 'change' }\r\n      ],\r\n      phoneNumber: [\r\n        { required: true, message: '電話號碼不能为空' },\r\n        { type: 'number', message: '號碼必须为数字值' }\r\n      ],\r\n      cardNumber: [\r\n        { required: true, message: '卡號不能为空' },\r\n        { type: 'number', message: '卡號必须为数字值' }\r\n      ],\r\n      level: [\r\n        { required: true, message: '请选择活會員卡級別', trigger: 'change' }\r\n      ],\r\n      amount: [\r\n        { required: true, message: '请輸入金額' },\r\n        { type: 'number', message: '金額必须为数字值' }\r\n      ],\r\n\r\n\r\n    })\r\n\r\n    const beforeAvatarUpload = (file) => {\r\n      const isJPG = file.type === 'image/jpeg'\r\n      const isLt2M = file.size / 1024 / 1024 < 2\r\n      if (!isJPG) {\r\n        $message.error('上传头像图片只能是 JPG 格式!')\r\n      }\r\n      if (!isLt2M) {\r\n        $message.error('上传头像图片大小不能超过 2MB!')\r\n      }\r\n      return isJPG && isLt2M\r\n    }\r\n\r\n    const submitForm = (formName) => {\r\n      refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          signup()\r\n        } else {\r\n          console.log('error submit!!')\r\n          return false\r\n        }\r\n      })\r\n    }\r\n    const resetForm = (formName) => {\r\n      refs[formName].resetFields()\r\n    }\r\n    const signup = (() => {\r\n      const fileArray = refs.upload.uploadFiles;\r\n      // 实例化FormData对象\r\n      const pic = new FormData();\r\n      var formData = new FormData(); // Currently empty\r\n      // 遍历文件数组，将所有文件存入fd中\r\n      fileArray.map(element => {\r\n        pic.append('avatar', element.raw);\r\n      });\r\n      //獲取用戶登入資訊\r\n      let requestData = {\r\n        name: ruleForm.name,\r\n        gender: ruleForm.gender,\r\n        phoneNumber: ruleForm.phoneNumber,\r\n        cardNumber: ruleForm.cardNumber,\r\n        level: ruleForm.level,\r\n        amount: ruleForm.amount,\r\n        note: ruleForm.note,\r\n        type: ruleForm.type,\r\n\r\n      }\r\n      for (var key in ruleForm) {\r\n        formData.append(key, ruleForm[key]);\r\n      }\r\n      console.log(requestData);\r\n      Signup(requestData, pic)\r\n        .then(response => {\r\n          root.$message({\r\n            message: '註冊成功',\r\n            type: 'success'\r\n          });\r\n          // root.$router.push({\r\n          //   name: 'Operation',\r\n          // })\r\n        })\r\n        .catch(error => {\r\n          root.$message({\r\n            message: '出現錯誤,請稍後再嘗試',\r\n            type: 'fail'\r\n          });\r\n        })\r\n    })\r\n\r\n\r\n    const handleRemove = (file, fileList) => {\r\n      hideUpload.value = false\r\n    }\r\n    const handlePictureCardPreview = (file) => {\r\n      dialogImageUrl.value = file.url\r\n      dialogVisible.value = true\r\n    }\r\n\r\n    const pictureOnchange = (file, fileList) => {\r\n      hideUpload.value = true\r\n    }\r\n\r\n\r\n    return {\r\n      submitForm,\r\n      resetForm,\r\n      pictureOnchange,\r\n      hideUpload,\r\n      handleRemove,\r\n      handlePictureCardPreview,\r\n      ruleForm,\r\n      rules,\r\n      Signup,\r\n      dialogVisible,\r\n      dialogImageUrl,\r\n      beforeAvatarUpload,\r\n    }\r\n  },\r\n}\r\n</script>\r\n<style lang=\"scss\" >\r\n#signup-wrap {\r\n  position: relative;\r\n}\r\n.upload {\r\n  width: 30%;\r\n  height: 400 px;\r\n}\r\n.upload_container {\r\n  width: 60%;\r\n  margin: 50px auto;\r\n}\r\n.form {\r\n  width: 60%;\r\n}\r\n\r\n.el-upload--picture-card {\r\n  .el-icon-plus {\r\n    line-height: 300px !important;\r\n  }\r\n}\r\n\r\n.hide .el-upload--picture-card {\r\n  display: none;\r\n}\r\n\r\n.el-upload--picture-card {\r\n  width: 100%;\r\n  height: 300px;\r\n}\r\n.el-upload-list--picture-card {\r\n  .el-upload-list__item {\r\n    width: 100% !important;\r\n    height: 300px !important;\r\n  }\r\n}\r\n.el-table .warning-row {\r\n  background: oldlace;\r\n}\r\n.el-table .success-row {\r\n  background: #f0f9eb;\r\n}\r\n\r\n.avatar-uploader {\r\n  /deep/.el-upload {\r\n    border: 1px dashed #d9d9d9;\r\n    border-radius: 6px;\r\n    cursor: pointer;\r\n    position: relative;\r\n    overflow: hidden;\r\n  }\r\n}\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: #409eff;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n}\r\n</style>\r\n"]}]}